<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>原根 - having little or no sense, use, or purpose.</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="TRAGEDY:ETERNITY" /><meta name="description" content="" />






<meta name="generator" content="Hugo 0.81.0 with theme even" />


<link rel="canonical" href="https://hizeci.github.io/post/%E5%8E%9F%E6%A0%B9/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

<link href="/sass/main.min.6a025d60334ccde9f765dedcf6936f4c2eb3ea8d22276e9f389bb2efc2d55e11.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">


<meta property="og:title" content="原根" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hizeci.github.io/post/%E5%8E%9F%E6%A0%B9/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-04-09T07:32:24&#43;08:00" />
<meta property="article:modified_time" content="2021-04-09T07:32:24&#43;08:00" />

<meta itemprop="name" content="原根">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2021-04-09T07:32:24&#43;08:00" />
<meta itemprop="dateModified" content="2021-04-09T07:32:24&#43;08:00" />
<meta itemprop="wordCount" content="5536">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="原根"/>
<meta name="twitter:description" content=""/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">菜</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">原根</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-04-09 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#费马小定理">费马小定理</a>
          <ul>
            <li><a href="#证明">证明</a></li>
          </ul>
        </li>
        <li><a href="#欧拉定理">欧拉定理</a>
          <ul>
            <li><a href="#证明-1">证明</a></li>
          </ul>
        </li>
        <li><a href="#扩展欧拉定理">扩展欧拉定理</a>
          <ul>
            <li><a href="#证明-2">证明</a></li>
          </ul>
        </li>
        <li><a href="#拉格朗日定理">拉格朗日定理</a>
          <ul>
            <li><a href="#证明-3">证明：</a></li>
          </ul>
        </li>
        <li><a href="#阶">阶</a>
          <ul>
            <li><a href="#性质">性质</a></li>
          </ul>
        </li>
        <li><a href="#裴蜀定理">裴蜀定理</a></li>
        <li><a href="#原根">原根</a>
          <ul>
            <li><a href="#定义">定义</a></li>
            <li><a href="#原根判定定理">原根判定定理</a></li>
            <li><a href="#原根存在定理">原根存在定理</a></li>
            <li><a href="#最小原根的数量级">最小原根的数量级</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>前置知识：</p>
<h2 id="费马小定理">费马小定理</h2>
<p>若$p$为素数，$\gcd(a,p)=1$，则$a^{p-1}\equiv a \pmod p$。</p>
<p>另一个形式：对于任意整数$a$，有$a^p\equiv a \pmod p$</p>
<h3 id="证明">证明</h3>
<p><img src="https://i.loli.net/2021/04/09/hNxU1P5XyZftJHG.png" alt="QQ图片20210409073823.png"></p>
<h2 id="欧拉定理">欧拉定理</h2>
<p>若$\gcd(a,m)=1$，则$a^{\varphi(m)}\equiv 1 \pmod m$</p>
<h3 id="证明-1">证明</h3>
<p>实际上这个证明过程跟上文费马小定理的证明过程是非常相似的：<strong>构造一个与$m$互质的数列</strong>，再进行操作。</p>
<p>若$r_1,r_2,\cdots ,r_{\varphi(m)}$为模$m$意义下的一个简化剩余系，则$ar_1,ar_2,\cdots,ar_{\varphi(m)}$也是模$m$意义下的一个简化剩余系。</p>
<p>所以有
$$
r_1r_2\cdots r_{\varphi(m)}\equiv ar_1\cdot ar_2\cdots ar_{\varphi(m)}\equiv a^{\varphi(m)}r_1r_2\cdots r_{\varphi(m)}\pmod m
$$</p>
<p>两边同时约去$r_1r_2\cdots r_{\varphi(m)}$，即可以得到$a^{\varphi(m)}\equiv 1 \pmod m$</p>
<p>当$m$为素数，由于$\varphi(m)=m-1$，代入欧拉定理即可得到费马小定理。</p>
<h2 id="扩展欧拉定理">扩展欧拉定理</h2>
<p>$$
a^b\equiv
\begin{cases}
a^{b\bmod\varphi(p)},,&amp;\gcd(a,,p)=1\<br>
a^b,&amp;\gcd(a,,p)\ne1,,b&lt;\varphi(p)\<br>
a^{b\bmod\varphi(p)+\varphi(p)},&amp;\gcd(a,,p)\ne1,,b\ge\varphi(p)
\end{cases}
\pmod p
$$</p>
<h3 id="证明-2">证明</h3>
<p>证明转载自 <a href="http://blog.csdn.net/synapse7/article/details/19610361">synapse7</a></p>
<ol>
<li>
<p>在 $a$ 的$a^0,a^1,a^2\cdots a^b$模 $m$ 的序列中，前 $r$ 个数（$a^0$ 到 $a^{r-1}$) 互不相同，从第 $r$ 个数开始，每 $s$ 个数就循环一次。</p>
<p>证明：由鸽巢定理易证。</p>
<p>我们把 $r$ 称为 $a$ 幂次模 $m$ 的循环起始点，$s$ 称为循环长度。（注意：$r$ 可以为 $0$）</p>
<p>用公式表述为：$a^r\equiv a^{r+s}\pmod{m}$</p>
</li>
<li>
<p>$a$ 为素数的情况</p>
<p>令 $m=p^rm'$，则 $\gcd(p,m')=1$，所以 $p^{\varphi(m')}\equiv 1\pmod{m'}$</p>
<p>又由于 $\gcd(p^r,m')=1$，所以 $\varphi(m') \mid \varphi(m)$，所以 $p^{\varphi(m)}\equiv 1 \pmod {m'}$，即 $p^{\varphi(m)}=km'+1$，两边同时乘以 $p^r$，得 $p^{r+\varphi(m)}=km+p^r$（因为 $m=p^rm'$）</p>
<p>所以 $p^r\equiv p^{r+s}\pmod m$，这里 $s=\varphi(m)$</p>
</li>
<li>
<p>推论：$p^b\equiv p^{r+(b-r) \mod \varphi(m)}\pmod m$</p>
</li>
<li>
<p>又由于 $m=p^rm'$，所以 $\varphi(m) \ge  \varphi(p^r)=p^{r-1}(p-1) \ge r$</p>
<p>所以 $p^r\equiv p^{r+\varphi(m)}\equiv p^{r \mod \varphi(m)+\varphi(m)}\pmod m$</p>
<p>所以 $p^b\equiv p^{r+(b-r) \mod \varphi(m)}\equiv p^{r \mod \varphi(m)+\varphi(m)+(b-r) \mod \varphi(m)}\equiv p^{\varphi(m)+b \mod \varphi(m)}\pmod m$</p>
<p>即 $p^b\equiv p^{b \mod \varphi(m)+\varphi(m)}\pmod m$</p>
</li>
<li>
<p>$a$ 为素数的幂的情况</p>
<p>是否依然有 $a^{r'}\equiv a^{r'+s'}\pmod m$？（其中 $s'=\varphi(m),a=p^k$)</p>
<p>答案是肯定的，由 2 知 $p^s\equiv 1 \pmod {m'} $，所以 $p^{s \times \frac{k}{\gcd(s,k)}} \equiv 1\pmod {m'}$，所以当 $s'=\frac{s}{\gcd(s,k)}$ 时才能有 $p^{s&rsquo;k}\equiv 1\pmod {m'}$，此时 $s' \mid s \mid \varphi(m)$，且 $r'= \lceil \frac{r}{k}\rceil \le r \le \varphi(m)$，由 $r',s'$ 与 $\varphi(m)$ 的关系，依然可以得到 $a^b\equiv a^{b \mod \varphi(m)+\varphi(m)}\pmod m$</p>
</li>
<li>
<p>$a$ 为合数的情况</p>
<p>只证 $a$ 拆成两个素数的幂的情况，大于两个的用数学归纳法可证。</p>
<p>设 $a=a_1a_2,a_i=p_i^{k_i}$，$a_i$ 的循环长度为 $s_i$；</p>
<p>则 $s \mid lcm(s_1,s_2)$，由于 $s_1 \mid \varphi(m),s_2 \mid \varphi(m)$，那么 $lcm(s_1,s_2) \mid \varphi(m)$，所以 $s \mid \varphi(m)$，$r=\max(\lceil \frac{r_i}{k_i} \rceil) \le \max(r_i) \le \varphi(m)$；</p>
<p>由 $r,s$ 与 $\varphi(m)$ 的关系，依然可以得到 $a^b\equiv a^{b \mod \varphi(m)+\varphi(m)}\pmod m$；</p>
<p>证毕。</p>
</li>
</ol>
<h2 id="拉格朗日定理">拉格朗日定理</h2>
<p>设$p$为素数，对于模$p$意义下的整系数多项式
$$
f(x)=a_nx^n+a_{n-1}x^{n-1}+\cdots a_0(p\not\mid a_n)
$$
的同余方程$f(x)\equiv 0 \pmod p$在模$p$意义下至多有$n$个不同的解。</p>
<h3 id="证明-3">证明：</h3>
<p>对$n$使用归纳法。</p>
<p>当$n=0$时，由于$p\not\mid a_0$，故$f(x)\equiv 0\pmod p$无解，定理对$n=0$的多项式$f(x)$都成立。</p>
<p>若命题对于$\deg f&lt;n$的$f$都成立，由反证法，假设存在一个满足题目条件的$f$在模$p$意义下有着至少$n+1$个不同的解$x_0,x_1,\dots ,x_n$。</p>
<p>可设$f(x)=f(x_0)=(x-x_0)g(x)$，则$g(x)$在模$p$意义下是一个至多$n-1$次的多项式。现在由$x_0,x_1,\dots,x_n$都是$f(x)\equiv 0\pmod p$的解，所以对$1\leq i\leq n$都有
$$
(x_i-x_0)g(x)\equiv f(x_i)-f(x_0)\equiv 0 \pmod p
$$
而$x_i\neq x_0 \pmod p$，故$g(x_i)\equiv 0 \pmod p$，从而$g(x_i)\equiv 0\pmod p$，从而$g(x)\equiv 0 \pmod p$有至少有$n$个根，与归纳假设矛盾。</p>
<p>所以，命题对$n$次多项式也成立，定理获证。</p>
<h2 id="阶">阶</h2>
<p>由欧拉定理可知，对$a\in \mathbb{Z},m\in \mathbb{N}^{*}$，若$\gcd(a,m)=1$，则$a^{\varphi(m)}\equiv 1 \pmod m$。</p>
<p>因此满足同余式$a^n\equiv 1\pmod m$的最小正整数$n$存在，这个$n$称作$a$模$m$的阶，记作$\delta_m(a)。$</p>
<h3 id="性质">性质</h3>
<blockquote>
<p><strong>性质1：</strong>$a,a^2,\dots,a^{\delta_m(a)}$模$m$两两不同余。</p>
</blockquote>
<p>**证明：**考虑反证，假设存在两个数$i\ne j$，且$a^i\equiv a^j \pmod m$，则有$a^{|i-j|}\equiv 1 \pmod p$。</p>
<p>但是显然的有：$0 &lt; |i-j| &lt; \delta_m(a)$，这与阶的最小性矛盾，故原命题成立。</p>
<hr>
<blockquote>
<p>**性质2：**若$a^n\equiv 1\pmod m$，则$\delta_m(a)\mid n$。</p>
</blockquote>
<p>**证明：**若$n$除以$\delta_m(a)$作带余除法，若$n=\delta_m(a)q+r,0\leq r&lt;\delta_m(a)$。</p>
<p>若$r&gt;0$，则
$$
a^r\equiv a^r(a^{\delta_m(a)})^q\equiv 1 \pmod m
$$
这与$\delta_m(a)$的最小性矛盾。故$r=0$，即$\delta_m(a)\mid n$。</p>
<p>据此还可以推出：</p>
<blockquote>
<p>若$a^p\equiv a^q\pmod m$，则有$p\equiv q \pmod {\delta_m(a)}$</p>
</blockquote>
<hr>
<p>还有两个与四则运算有关的重要性质。</p>
<blockquote>
<p>**性质3：**设$m\in \mathbb{N}^{*}$，$a,b\in \mathbb{Z}$，$\gcd(a,m)=\gcd(b,m)=1$，则
$$
\delta_m(ab)=\delta_m(a)\delta_m(b)
$$
的充分必要条件是
$$
\gcd(\delta_m(a),\delta_m(b))=1
$$</p>
</blockquote>
<p><strong>证明：</strong></p>
<p><strong>必要性</strong></p>
<p>由$a^{\delta_m(a)}\equiv 1 \pmod m$及$b^{\delta_m(b)}\equiv 1 \pmod m$，可知
$$
(ab)^{\operatorname{lcm}(\delta_m(a),\delta_m(b))}\equiv 1 \pmod m
$$
由前面所述阶的性质，有
$$
\delta_m(ab)\mid \operatorname{lcm}\big(\delta_m(a),\delta_m(b)\big)
$$
又由于$\delta_m(ab)=\delta_m(a)\delta_m(b)$，故
$$
\delta_m(a)\delta_m(b)\mid \operatorname{lcm}\big(\delta_m(a),\delta_m(b)\big)
$$
即$\gcd(\delta_m(a),\delta_m(b))=1$。</p>
<p><strong>充分性</strong></p>
<p>由$(ab)^{\delta_m(ab)}\equiv 1\pmod m$可知
$$
1\equiv (ab)^{\delta_m(ab)\delta_m(b)}\equiv a^{\delta_m(ab)} \pmod m
$$
故$\delta_m(a)\mid \delta_m(ab)\delta_m(b)$。结合$\gcd(\delta_m(a),\delta_m(b))=1$即得
$$
\delta_m(a)\mid \delta_m(ab)
$$
对称地，同理可得
$$
\delta_m(b)\mid \delta_m(ab)
$$
所以
$$
\delta_m(a)\delta_m(b)\mid \delta_m(ab)
$$
另一方面，有
$$
(ab)^{\delta_m(a)\delta_m(b)}\equiv (a^{\delta_m(a)})^{\delta_m(b)}\times (b^{\delta_m{(b)}})^{\delta_m(a)}\equiv 1 \pmod m
$$
故
$$
\delta_m(ab)\mid \delta_m(a)\delta_m(b)
$$
所以
$$
\delta_m(ab)=\delta_m(a)\delta_m(b)
$$</p>
<hr>
<blockquote>
<p>**性质4：**设$k\in \mathbb{N}$，$m\in \mathbb{N}^{*}$，$a\in \mathbb {Z}$，$\gcd(a,m)=1$则
$$
\delta_m(a^k)=\frac{\delta_m(a)}{\gcd(\delta_m(a),k)}
$$</p>
</blockquote>
<p>**证明：**注意到：
$$
a^{k\delta_m(a^k)}=(a^k)^{\delta_m(a^k)}\equiv 1 \pmod m
$$</p>
<p>$$
\Rightarrow \delta_m(a)\mid k\delta_m(a^k)
$$</p>
<p>$$
\Rightarrow \dfrac{\delta_m(a)}{\gcd\big(\delta_m(a),k\big)}\mid\delta_m(a^k)
$$</p>
<p>另一方面，由 $a^{\delta_m(a)}\equiv 1 \pmod m$，可知：</p>
<p>$$
(a^k)^{\frac{\delta_m(a)}{\gcd(\delta_m(a),k)}}=(a^{\delta_m(a)})^{\frac{k}{\gcd(\delta_m(a),k)}}\equiv 1 \pmod m
$$</p>
<p>故：</p>
<p>$$
\delta_m(a^k)\mid\dfrac{\delta_m(a)}{\gcd(\delta_m(a),k)}
$$</p>
<p>综合以上两点，得：</p>
<p>$$
\delta_m(a^k)=\dfrac{\delta_m(a)}{\gcd(\delta_m(a),k)}
$$</p>
<hr>
<h2 id="裴蜀定理">裴蜀定理</h2>
<p>若$a,b\in \mathbb{N}$且$a+b\ne 0$，则存在整数$x,y$使得$ax+by=\gcd(a,b)$</p>
<p><strong>证明：</strong></p>
<ol>
<li>
<p>若任何一个等于 $0$, 则 $\gcd(a,b)=a$. 这时定理显然成立。</p>
</li>
<li>
<p>若 $a,b$ 不等于 $0$.</p>
<p>由于 $\gcd(a,b)=\gcd(a,-b)$,</p>
<p>不妨设 $a,b$ 都大于 $0$，$a\geq b,\gcd(a,b)=d$.</p>
<p>对 $ax+by=d$, 两边同时除以 $d$, 可得 $a_1x+b_1y=1$, 其中 $(a_1,b_1)=1$.</p>
<p>转证 $a_1x+b_1y=1$.</p>
<p>我们先回顾一下辗转相除法是怎么做的，由 $\gcd(a, b) \rightarrow \gcd(b,a\bmod b) \rightarrow &hellip;$ 我们把模出来的数据叫做 $r$ 于是，有</p>
<p>$$
\gcd(a_1,b_1)=\gcd(b_1,r_1)=\gcd(r_1,r_2)=\cdots=(r_{n-1},r_n)=1
$$</p>
<p>把辗转相除法中的运算展开，做成带余数的除法，得</p>
<p>$$
\begin{aligned}a_1 &amp;= q_1b+r_1 &amp;(0\leq r_1&lt;b_1) \ b_1 &amp;= q_2r_1+r_2 &amp;(0\leq r_2&lt;r_1) \ r_1 &amp;= q_3r_2+r_3 &amp;(0\leq r_3&lt;r_2) \ &amp;\cdots \ r_{n-3} &amp;= q_{n-1}r_{n-2}+r_{n-1} \ r_{n-2} &amp;= q_nr_{n-1}+r_n \ r_{n-1} &amp;= q_{n+1}r_n\end{aligned}
$$</p>
<p>不妨令辗转相除法在除到互质的时候退出则 $r_n=1$ 所以有（$q$ 被换成了 $x$，为了符合最终形式）</p>
<p>$$
r_{n-2}=x_nr_{n-1}+1
$$</p>
<p>即</p>
<p>$$
1=r_{n-2}-x_nr_{n-1}
$$</p>
<p>由倒数第三个式子 $r_{n-1}=r_{n-3}-x_{n-1}r_{n-2}$ 代入上式，得</p>
<p>$$
1=(1+x_nx_{n-1})r_{n-2}-x_nr_{n-3}
$$</p>
<p>然后用同样的办法用它上面的等式逐个地消去 $r_{n-2},\cdots,r_1$,</p>
<p>可证得 $1=a_1x+b_1y$.
这样等于是一般式中 $d=1$ 的情况。</p>
</li>
</ol>
<h2 id="原根">原根</h2>
<h3 id="定义">定义</h3>
<p>设$m\in \mathbb{N}^{*}$，设$a\in \mathbb{Z}$。设$\gcd(a,m)=1$，且$\delta_m(a)=\varphi(m)$，则称$a$为模$m$的原根。</p>
<h3 id="原根判定定理">原根判定定理</h3>
<p>若一个数$g$是模$m$的原根，则有对于$\varphi(m)$任何大于$1$且不为自身的因数$p$，都有$g^{\varphi(m)/p}\not\equiv 1\pmod m$。</p>
<p>**证明：**假设存在一个$t&lt;\varphi (p)$使得$a_t\equiv 1\pmod p$且$\forall i\in\left[1,m\right]:a^{\frac{\varphi(p)}{d_{i}}}\not\equiv 1\pmod{p}$</p>
<p>由裴蜀定理得，一定存在一组$k,x$满足$kt=x\varphi(p)+\gcd(t,\varphi(p))$，由欧拉定理/费马小定理得到
$$
a^{\varphi(p)\equiv 1 \pmod p}
$$
故有
$$
1\equiv a^{kt}\equiv a^{x\varphi(p)+\gcd(t,\varphi(p))}\equiv a^{\gcd(t,\varphi(p))}\pmod{p}
$$
又有 $t&lt;\varphi(p)$，故 $\gcd(t,\varphi(p))\leqslant t&lt;\varphi(p)$。</p>
<p>又 $\gcd(t,\varphi(p))\mid(\varphi(p))$，故 $\gcd(t,\varphi(p))$ 必至少整除 ${\frac{\varphi(p)}{d_{1}}},{\frac{\varphi(p)}{d_{2}}},\ldots,{\frac{\varphi(p)}{d_{m}}}$ 中的至少一个，设 $\gcd(t,\varphi(p))\mid {\frac{\varphi(p)}{d_{i}}}$，则 $a^{\frac{\varphi(p)}{d_{i}}}\equiv a^{\gcd(t,\varphi(p))}\equiv 1\pmod{p}$。</p>
<p>故假设不成立，原命题成立。</p>
<h3 id="原根存在定理">原根存在定理</h3>
<p>一个数$m$存在原根当且仅当$m=2,4,p^{\alpha},2p^{\alpha}$，其中$p$为奇素数，$\alpha\in \mathbb{N}^{*}$</p>
<p>我们来证明它，分成 $m=2,4$、$m=p^{\alpha}$、$m=2p^{\alpha}$ 与 $m\ne 2,4,p,p^{\alpha}$，四个部分。</p>
<ul>
<li>
<p>$m=2,4$，原根显然存在。</p>
</li>
<li>
<p>$m=p^{\alpha}$，其中 $p$ 为奇素数，$\alpha\in \mathbb{N}^*$。</p>
<blockquote>
<p><strong>定理 1</strong>：对于奇素数 $p$，$p$ 有原根。</p>
</blockquote>
<p><strong>证明</strong>：先证一个引理：</p>
<blockquote>
<blockquote>
<p><strong>引理</strong>：设 $a$ 与 $b$ 是与 $p$ 互素的两个整数，则存在 $c\in\mathbb{Z}$ 使得 $\delta_p(c)=\operatorname{lcm}\big(\delta_p(a),\delta_p(b)\big)$。</p>
</blockquote>
<p><strong>证明</strong>：我们先将 $\delta_m(a),\delta_m(b)$ 表示成质因数分解的形式：</p>
<p>$$
\left(\delta_m(a)=\prod_{i=1}^k{p_i^{\alpha_i}},\delta_m(b)=\prod_{i=1}^k{p_i^{\beta_i}} \right)
$$</p>
<p>接着将它们表示成如下形式：</p>
<p>$$
\delta_m(a)=XY,\delta_m(b)=ZW
$$</p>
<p>其中：</p>
<p>$$
Y=\prod_{i=1}^k{p_i^{[\alpha_i&gt;\beta_i]\alpha_i}},X=\dfrac {\delta_m(a)}Y
$$</p>
<p>$$
W=\prod_{i=1}^k{p_i^{[\alpha_i\le\beta_i]\beta_i}},Z=\dfrac {\delta_m(b)}W
$$</p>
<p>则由阶的 <strong>性质 $4$</strong>，可得：</p>
<p>$$
\delta_m\left(a^X\right)=\dfrac{\delta_m(a)}{\gcd\big(\delta_m(a),X\big)}=\dfrac {XY}X=Y
$$</p>
<p>同理：</p>
<p>$$
\delta_m\left(b^Z\right)=W
$$</p>
<p>又因为显然有 $\gcd(Y,W)=1$，$YZ=\operatorname{lcm}\big(\delta_p(a),\delta_p(b)\big)$，则再由阶的 <strong>性质 $1$</strong>，可得：</p>
<p>$$
\delta_m\left(a^Xb^Z\right)=\delta_m\left(a^X\right)\delta_m\left(b^Z\right)=YZ=\operatorname{lcm}\big(\delta_p(a),\delta_p(b)\big)
$$</p>
<p>于是令 $c=a^Xb^Z$ 则原命题得证。</p>
<p>回到原命题，对 $1 \sim (p-1)$ 依次两两使用引理，可知存在 $g\in \mathbb{Z}$ 使得</p>
</blockquote>
<p>$$
\delta_p(g)=\operatorname{lcm}\big(\delta_p(1),\delta_p(2),\cdots,\delta_p(p-1)\big)
$$</p>
<p>这表明 $\delta_p(j)\mid\delta_p(g)(j=1,2,\cdots,p-1)$，所以 $j=1,2,\cdots,p-1$ 都是同余方程</p>
<p>$$
x^{\delta_p(g)}\equiv 1\pmod p
$$</p>
<p>的根。由拉格朗日定理，可知方程的次数 $\delta_p(g) \geq p-1$。</p>
<p>又由费马小定理，易知 $\delta_p(g) \leq p-1$，故 $\delta_p(g)=p-1=\varphi(p)$。</p>
<p>综上可知 $g$ 为模 $p$ 的原根。</p>
</li>
</ul>
<hr>
<blockquote>
<p><strong>定理 2</strong>：对于奇素数 $p$，$\alpha \in \mathbb{N}^{*}$，$p^\alpha$ 有原根。</p>
</blockquote>
<p><strong>证明</strong>：一个基本的想法是将模 $p$ 的原根平移。</p>
<p>先证明一个引理：</p>
<blockquote>
<blockquote>
<p><strong>引理</strong>：存在模 $p$ 的原根 $g$，使得 $g^{p-1}\not\equiv 1 \pmod {p^2}$。</p>
</blockquote>
<p><strong>证明</strong>：事实上，任取模 $p$ 的原根 $g$，若 $g$ 不满足条件，我们认定 $g+p$ 满足条件。</p>
<p>易知 $g+p$ 也是模 $p$ 的原根。</p>
<p>我们有</p>
<p>$$
\begin{aligned}(g+p)^{p-1}&amp;\equiv C_{p-1}^0g^{p-1}+C_{p-1}^1pg^{p-2}\&amp;\equiv g^{p-1}+p(p-1)g^{p-2}\&amp;\equiv 1-pg^{p-2}\&amp;\not\equiv 1 \pmod {p^2}\end{aligned}
$$</p>
</blockquote>
<p>回到原题，我们证明若 $g$ 是一个满足引理条件的原根，则对任意 $\alpha\in\mathbb{N}^{*}$，$g$ 是模 $p^{\alpha}$ 的原根。</p>
<p>首先，证明下面的结论：对任意 $\beta\in\mathbb{N}^{*}$，都可设</p>
<p>$$
g^{\varphi(p^\beta)}=1+p^{\beta}\times k_{\beta}
$$</p>
<p>这里 $p\nmid k_{\beta}$。事实上，$\beta=1$ 时，由 $g$ 的选取可知结论成立。现设上式对 $\beta$ 时成立，则</p>
<p>$$
\begin{aligned}g^{\varphi(p^{\beta+1})}&amp;=(g^{\varphi(p^{\beta})})^{p}\&amp;=(1+p^{\beta}\times k_{\beta})^p\&amp;\equiv 1+p^{\beta+1}\times k_{\beta} \pmod {p^{\beta+2}}\end{aligned}
$$</p>
<p>结合 $p\nmid k_{\beta}$ 可知命题对 $\beta+1$ 成立。</p>
<p>所以命题对任意 $\beta\in\mathbf{N}^{*}$ 都成立。</p>
<p>其次，记 $\delta=\delta_{p^\alpha}(g)$，则由欧拉定理，可知 $\delta\mid p^{\alpha-1}(p-1)$。</p>
<p>而由 $g$ 为模 $p$ 的原根，及 $g^{\delta}\equiv 1\pmod {p^\alpha}$。</p>
<p>所以可设 $\delta=p^{\beta-1}(p-1)$，这里 $1\leq \beta\leq \alpha$。</p>
<p>现在利用之前的结论，可知：</p>
<p>$$
g^{\varphi(p^{\beta})}\not\equiv 1\pmod {p^{\beta+1}}\Rightarrow g^{\delta}\not\equiv 1\pmod {p^{\beta+1}}
$$</p>
<p>结合 $g^{\delta}\equiv 1\pmod {p^\alpha}$ 可知 $\beta \geq \alpha$。</p>
<p>综上可知，$\beta=\alpha$，即：</p>
<p>$$
\delta_{p^{\alpha}}(g)=p^{\alpha-1}(p-1)=\varphi(p^\alpha)
$$</p>
<p>从而，$g$ 是模 $p^{\alpha}$ 的原根。</p>
<ul>
<li>
<p>$m=2p^{\alpha}$，其中 $p$ 为奇素数，$\alpha\in\mathbb{N}^*$。</p>
<blockquote>
<p><strong>定理 $3$</strong>：对于奇素数 $p$，$\alpha\in\mathbf{N}^{*}$，$2p^{\alpha}2$ 的原根存在。</p>
</blockquote>
<p><strong>证明</strong>：设 $g$ 是模 $p^{\alpha}$ 的原根，则 $g+p^{\alpha}$ 也是模 $p^{\alpha}$ 的原根。</p>
<p>在 $g$ 和 $g+p^{\alpha}$ 中有一个是奇数，设这个奇数是 $G$，则 $\gcd(G,2p^{\alpha})=1$。</p>
<p>由欧拉定理，$\delta_{2p^{\alpha}}(G)\mid\varphi(2p^{\alpha})$。</p>
<p>而 $G^{\delta_{2p^{\alpha}}(G)}\equiv 1\pmod {2p^{\alpha}}$，故：</p>
<p>$$
G^{\delta_{2p^{\alpha}}(G)}\equiv 1 \pmod {p^{\alpha}}
$$</p>
<p>利用 $G$ 为模 $p^{\alpha}$ 的原根可知 $\varphi(p^{\alpha})\mid\delta_{2p^{\alpha}}(G)$。</p>
<p>结合 $\varphi(p^{\alpha})=\varphi(2p^{\alpha})$ 可知 $G$ 为模 $2p^{\alpha}$ 的原根。</p>
</li>
<li>
<p>$m\ne 2,4,p^{\alpha},p^{\alpha}$，其中 $p$ 为奇素数，$\alpha\in\mathbb{N}^*$。</p>
<blockquote>
<p><strong>定理 $4$</strong>：对于 $m\ne 2,4$，且不存在奇素数 $p$ 及 $\alpha \in \mathbb{N}^{*}$ 使得 $m=p^{\alpha},2p^{\alpha}$，模 $m$ 的原根不存在。</p>
</blockquote>
<p><strong>证明</strong>：对于 $m=2^{\alpha}$，$\alpha\in\mathbb{N}^{*},\alpha\geq 3$，则对任意奇数 $a=2k+1$ 均有：</p>
<p>$$
\begin{aligned}a^{2^{\alpha-2}}&amp;=(2k+1)^{2^{\alpha-2}}\&amp;\equiv 1+C_{2^{\alpha-2}}^1(2k)+C_{2^{\alpha-2}}^{2}(2k)^{2}\&amp;\equiv1+2^{\alpha-1}k+2^{\alpha-1}(2^{\alpha-2}-1)k^2\&amp;\equiv 1+2^{\alpha-1}(k+(2^{\alpha-2}-1)k)\&amp;\equiv 1 \pmod {2^{\alpha}}\end{aligned}
$$</p>
<p>其中最后一步用到 $k$ 与 $(2^{\alpha-2}-1)k$ 同奇偶，故其和为偶数。</p>
<p>若 $m$ 不是 $2$ 的幂，且 $m$ 为符合题目条件的数，则可设 $m=rt$，这里 $2&lt;r&lt;t$ 且 $\gcd(r,t)=1$。</p>
<p>此时，若 $\gcd(a,m)=1$，由欧拉定理可知：</p>
<p>$$
a^{\varphi(r)}\equiv 1 \pmod r;,\quad a^{\varphi(t)}\equiv1\pmod t
$$</p>
<p>注意到 $n&gt;2$ 时，$\varphi(n)$ 为偶数，所以：</p>
<p>$$
a^{\frac{1}{2}\varphi(r)\varphi(t)}\equiv 1\pmod {rt}
$$</p>
<p>进而：</p>
<p>$$
\delta_m(a)\leq\dfrac{1}{2}\varphi(r)\varphi(t)=\dfrac{1}{2}\varphi(rt)=\dfrac{1}{2}\varphi(m)&lt;\varphi(m)
$$</p>
<p>由原根定义可得：模 $m$ 的原根不存在。</p>
<hr>
</li>
</ul>
<p>综合以上 $4$ 个定理，我们便给出了一个数存在原根的充要条件。</p>
<h3 id="最小原根的数量级">最小原根的数量级</h3>
<p>王元于 $1959$ 年证明了若 $m$ 有原根，其最小原根是不多于 $m^{0.25}$ 级别的。此处略去证明。</p>
<p>这保证了我们暴力找一个数的最小原根，复杂度是可以接受的。</p>
    </div>

    
<footer class="post-footer">
      
      <nav class="post-nav">
        
        <a class="next" href="/post/%E5%85%B3%E4%BA%8E%E7%BB%B4%E6%8A%A4%E5%8A%A8%E6%80%81%E7%9A%84%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/">
            <span class="next-text nav-default">关于维护动态的树的直径</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  <span id="/post/%E5%8E%9F%E6%A0%B9/" class="leancloud_visitors" data-flag-title="原根">
		<span class="post-meta-item-text">文章阅读量 </span>
		<span class="leancloud-visitors-count">0</span>
		<p></p>
	  </span>
  <div id="vcomments"></div>
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <script type="text/javascript">
    new Valine({
        el: '#vcomments' ,
        appId: 'F8xu4BfgVST0H6107wApro6n-gzGzoHsz',
        appKey: 'qlgvukJKICXwyoy3NkVygfIu',
        notify:  false ,
        verify:  false ,
        avatar:'mm',
        placeholder: '说点什么吧...',
        visitor:  true 
    });
  </script>

  

      </div>
    </main>

    

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>



<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
    docsearch({
    apiKey: "97c22106dbe3955818bc05a0be5f3511",
    indexName: "hizeci's blog",
    appId: "9HLPOQJVAD",
    inputSelector: '.docsearch-input',
    debug: false,
    });
</script>


</body>
</html>
